<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory">Chapter 19. Configuration</title><link rel="stylesheet" href="css/weld.css" type="text/css"/><meta xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" name="generator" content="DocBook XSL-NS Stylesheets V1.74.0"/><meta xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" http-equiv="Content-Type" content="text/html; charset=UTF-8"/><link rel="home" href="index.html" title="Weld 2.3.0.Final - CDI Reference Implementation"/><link rel="up" href="part-5.html" title="Part V. Weld Reference Guide"/><link rel="prev" href="environments.html" title="Chapter 18. Application servers and environments supported by Weld"/><link rel="next" href="logging.html" title="Chapter 20. Logging"/></head><body><p xmlns:d="http://docbook.org/ns/docbook" id="title"><a href="http://weld.cdi-spec.org" class="site_href"><strong>Weld Site</strong></a><a href="http://docs.jboss.org/" class="doc_href"><strong>Community Documentation</strong></a></p><ul xmlns:d="http://docbook.org/ns/docbook" class="docnav"><li class="previous"><a accesskey="p" href="environments.html"><strong>Prev</strong></a></li><li class="next"><a accesskey="n" href="logging.html"><strong>Next</strong></a></li></ul><div class="chapter" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="configure"/>Chapter 19. Configuration</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="configure.html#_weld_configuration">19.1. Weld configuration</a></span></dt><dd><dl><dt><span class="section"><a href="configure.html#relaxedConstruction">19.1.1. Relaxed construction</a></span></dt><dt><span class="section"><a href="configure.html#_concurrent_deployment_configuration">19.1.2. Concurrent deployment configuration</a></span></dt><dt><span class="section"><a href="configure.html#_thread_pool_configuration">19.1.3. Thread pool configuration</a></span></dt><dt><span class="section"><a href="configure.html#_non_portable_mode_during_application_initialization">19.1.4. Non-portable mode during application initialization</a></span></dt><dt><span class="section"><a href="configure.html#_bounding_the_cache_size_for_resolved_injection_points">19.1.5. Bounding the cache size for resolved injection points</a></span></dt><dt><span class="section"><a href="configure.html#_debugging_generated_bytecode">19.1.6. Debugging generated bytecode</a></span></dt><dt><span class="section"><a href="configure.html#_injectable_reference_lookup_optimization">19.1.7. Injectable reference lookup optimization</a></span></dt><dt><span class="section"><a href="configure.html#_bean_identifier_index_optimization">19.1.8. Bean identifier index optimization</a></span></dt><dt><span class="section"><a href="configure.html#config-dev-mode">19.1.9. Development Mode</a></span></dt><dt><span class="section"><a href="configure.html#_default_bean_names">19.1.10. Default bean names</a></span></dt></dl></dd><dt><span class="section"><a href="configure.html#_excluding_classes_from_scanning_and_deployment">19.2. Excluding classes from scanning and deployment</a></span></dt><dt><span class="section"><a href="configure.html#_mapping_cdi_contexts_to_http_requests">19.3. Mapping CDI contexts to HTTP requests</a></span></dt></dl></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="_weld_configuration"/>19.1. Weld configuration</h2></div></div></div><p>Weld can be configured per application through the set of properties. All the supported configuration properties are described in the following subsections.</p><p>Each configuration property can be specified (by priority in descending order):</p><div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="orderedlist"><ol><li>In a properties file named <code class="literal">weld.properties</code></li><li>As a system property</li><li>By a bootstrap configuration provided by an integrator</li></ol></div><p>If a configuration key is set in multiple sources (e.g. as a system property and in a properties file), the value from the source with higher priority is taken, other values are ignored. Unsupported configuration keys are ignored. If an invalid configuration property value is set, the container automatically detects the problem and treats it as a deployment problem.</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="relaxedConstruction"/>19.1.1. Relaxed construction</h3></div></div></div><p>CDI requires that beans that are normal-scoped, intercepted or decorated always define a no-argument constructor.
This requirement applies even if the bean already defines an <code class="literal">@Inject</code> annotated constructor with parameters.
This is purely a technical requirement implied by how Java allocates class instances.</p><p>Weld is however able to operate fine even if this requirement is not met.
Weld uses special non-portable JVM APIs that allow it to allocate proxy instances without calling proxy’s constructor.
This mode is not enabled by default. It can be enabled using the following configuration option:</p><div class="table"><a id="d0e5991"/><p class="title"><b>Table 19.1. Supported configuration properties</b></p><div class="table-contents"><table summary="Supported configuration properties" border="1"><colgroup><col/><col/><col/></colgroup><thead><tr><th align="left" valign="top">Configuration key</th><th align="left" valign="top">Default value</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">org.jboss.weld.construction.relaxed</code></p></td><td align="left" valign="top"><p>false</p></td><td align="left" valign="top"><p>If set to <code class="literal">true</code>, then requirements on bean constructors are relaxed.</p></td></tr></tbody></table></div></div><br class="table-break"/></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="_concurrent_deployment_configuration"/>19.1.2. Concurrent deployment configuration</h3></div></div></div><p>By default Weld supports concurrent loading and deploying of beans.
However, in certain deployment scenarios the default setup may not be
appropriate.</p><div class="table"><a id="d0e6026"/><p class="title"><b>Table 19.2. Supported configuration properties</b></p><div class="table-contents"><table summary="Supported configuration properties" border="1"><colgroup><col/><col/><col/></colgroup><thead><tr><th align="left" valign="top">Configuration key</th><th align="left" valign="top">Default value</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">org.jboss.weld.bootstrap.concurrentDeployment</code></p></td><td align="left" valign="top"><p>true</p></td><td align="left" valign="top"><p>If set to false, <code class="literal">ConcurrentDeployer</code> and
<code class="literal">ConcurrentValidator</code> will not be used.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">org.jboss.weld.bootstrap.preloaderThreadPoolSize</code></p></td><td align="left" valign="top"><p><code class="literal">Math.max(1, Runtime.getRuntime().availableProcessors() - 1)</code></p></td><td align="left" valign="top"><p>Weld is
capable of resolving observer methods for container lifecycle events in
advance while bean deployer threads are blocked waiting for I/O
operations (such as classloading). This process is called preloading and
leads to better CPU utilization and faster application startup time.
This configuration option specifies the number of threads used for
preloading. If set to 0, preloading is disabled.</p></td></tr></tbody></table></div></div><br class="table-break"/><div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>Note</h2><p>The bootstrap configuration may be altered using the deprecated <code class="literal">org.jboss.weld.bootstrap.properties</code> file located on the classpath (e.g. <code class="literal">WEB-INF/classes/org.jboss.weld.bootstrap.properties</code> in a web archive). The keys are <code class="literal">concurrentDeployment</code> and <code class="literal">preloaderThreadPoolSize</code>.</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="_thread_pool_configuration"/>19.1.3. Thread pool configuration</h3></div></div></div><p>For certain types of tasks Weld uses its own thread pool. The thread
pool is represented by the <code class="literal">ExecutorServices</code> service.</p><div class="table"><a id="d0e6094"/><p class="title"><b>Table 19.3. Supported configuration properties</b></p><div class="table-contents"><table summary="Supported configuration properties" border="1"><colgroup><col/><col/><col/></colgroup><thead><tr><th align="left" valign="top">Configuration key</th><th align="left" valign="top">Default value</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">org.jboss.weld.executor.threadPoolType</code></p></td><td align="left" valign="top"><p><code class="literal">FIXED</code></p></td><td align="left" valign="top"><p>The type of the thread pool. Possible values
are: <code class="literal">FIXED</code>, <code class="literal">FIXED_TIMEOUT</code>, <code class="literal">NONE</code>, <code class="literal">SINGLE_THREAD</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">org.jboss.weld.executor.threadPoolSize</code></p></td><td align="left" valign="top"><p><code class="literal">Runtime.getRuntime().availableProcessors()</code></p></td><td align="left" valign="top"><p>The
number of threads to be used for bean loading and deployment.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">org.jboss.weld.executor.threadPoolKeepAliveTime</code></p></td><td align="left" valign="top"><p>60 seconds</p></td><td align="left" valign="top"><p>Passed to the constructor of the
ThreadPoolExecutor class, maximum time that excess idle threads will
wait for new tasks before terminating.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">org.jboss.weld.executor.threadPoolDebug</code></p></td><td align="left" valign="top"><p>false</p></td><td align="left" valign="top"><p>If set to true, debug timing information is
printed to the standard output.</p></td></tr></tbody></table></div></div><br class="table-break"/><div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>Note</h2><p>It’s possible to alter the thread pool configuration using the deprecated <code class="literal">org.jboss.weld.executor.properties</code> file located on the classpath. The keys are <code class="literal">threadPoolType</code>, <code class="literal">threadPoolSize</code>, <code class="literal">threadPoolKeepAliveTime</code> and <code class="literal">threadPoolDebug</code>.</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="_non_portable_mode_during_application_initialization"/>19.1.4. Non-portable mode during application initialization</h3></div></div></div><p>By default the application initialization is performed in the portable
mode which denotes specification-compliant behaviour. However it’s also
possible to enable the non-portable mode, in which some definition
errors and deployment problems do not cause application initialization
to abort. Currently the non-portable mode allows extension developers to
call all the <code class="literal">BeanManager</code>'s methods before the
<code class="literal">AfterDeploymentValidation</code> event is fired.</p><div class="table"><a id="d0e6196"/><p class="title"><b>Table 19.4. Supported configuration properties</b></p><div class="table-contents"><table summary="Supported configuration properties" border="1"><colgroup><col/><col/><col/></colgroup><thead><tr><th align="left" valign="top">Configuration key</th><th align="left" valign="top">Default value</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">org.jboss.weld.nonPortableMode</code></p></td><td align="left" valign="top"><p>false</p></td><td align="left" valign="top"><p>If set to <code class="literal">true</code>, the non-portable mode is enabled.</p></td></tr></tbody></table></div></div><br class="table-break"/><div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>Note</h2><p>The main purpose of the non-portable mode is to support some legacy
extensions. It’s highly recommended to use the portable mode whenever
possible - non-portable mode may lead to unexpected behaviour during
initialization process.</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="_bounding_the_cache_size_for_resolved_injection_points"/>19.1.5. Bounding the cache size for resolved injection points</h3></div></div></div><p>Weld caches already resolved injection points in order to resolve them
faster in the future. A separate type-safe resolver exists for
beans, decorators, disposers, interceptors and observers. Each of them
stores resolved injection points in its cache, which maximum size is
bounded by a default value (common to all of them).</p><div class="table"><a id="d0e6234"/><p class="title"><b>Table 19.5. Supported configuration properties</b></p><div class="table-contents"><table summary="Supported configuration properties" border="1"><colgroup><col/><col/><col/></colgroup><thead><tr><th align="left" valign="top">Configuration key</th><th align="left" valign="top">Default value</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">org.jboss.weld.resolution.cacheSize</code></p></td><td align="left" valign="top"><p>65536</p></td><td align="left" valign="top"><p>The upper bound of the cache.</p></td></tr></tbody></table></div></div><br class="table-break"/></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="_debugging_generated_bytecode"/>19.1.6. Debugging generated bytecode</h3></div></div></div><p>For debugging purposes, it’s possible to dump the generated bytecode of client proxies and enhanced subclasses to the filesystem.</p><div class="table"><a id="d0e6266"/><p class="title"><b>Table 19.6. Supported configuration properties</b></p><div class="table-contents"><table summary="Supported configuration properties" border="1"><colgroup><col/><col/><col/></colgroup><thead><tr><th align="left" valign="top">Configuration key</th><th align="left" valign="top">Default value</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">org.jboss.weld.proxy.dump</code></p></td><td align="left" valign="top"> </td><td align="left" valign="top"><p>The file path where the files should be stored.</p></td></tr></tbody></table></div></div><br class="table-break"/></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="_injectable_reference_lookup_optimization"/>19.1.7. Injectable reference lookup optimization</h3></div></div></div><p>For certain combinations of scopes, the container is permitted to optimize an injectable reference lookup. Enabling this feature brings some performance boost but causes <code class="literal">javax.enterprise.context.spi.AlterableContext.destroy()</code> not to work properly for <code class="literal">@ApplicationScoped</code> and <code class="literal">@RequestScoped</code> beans. Therefore, the optimization is disabled by default.</p><div class="table"><a id="d0e6305"/><p class="title"><b>Table 19.7. Supported configuration properties</b></p><div class="table-contents"><table summary="Supported configuration properties" border="1"><colgroup><col/><col/><col/></colgroup><thead><tr><th align="left" valign="top">Configuration key</th><th align="left" valign="top">Default value</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">org.jboss.weld.injection.injectableReferenceOptimization</code></p></td><td align="left" valign="top"><p>false</p></td><td align="left" valign="top"><p>If set to <code class="literal">true</code>, the optimization is enabled.</p></td></tr></tbody></table></div></div><br class="table-break"/></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="_bean_identifier_index_optimization"/>19.1.8. Bean identifier index optimization</h3></div></div></div><p>This optimization is used to reduce the HTTP session replication overhead. However, the inconsistency detection mechanism may cause problems in some development environments. It’s recommended to disable this optimization during the development phase.</p><div class="table"><a id="d0e6340"/><p class="title"><b>Table 19.8. Supported configuration properties</b></p><div class="table-contents"><table summary="Supported configuration properties" border="1"><colgroup><col/><col/><col/></colgroup><thead><tr><th align="left" valign="top">Configuration key</th><th align="left" valign="top">Default value</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">org.jboss.weld.serialization.beanIdentifierIndexOptimization</code></p></td><td align="left" valign="top"><p>true (false in weld-servlet)</p></td><td align="left" valign="top"><p>If set to <code class="literal">true</code>, the optimization is enabled.</p></td></tr></tbody></table></div></div><br class="table-break"/><div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>Note</h2><p>This optimization is disabled by default in <a class="link" href="environments.html#weld-servlet" title="18.3. Servlet containers (such as Tomcat or Jetty)">Servlet containers</a>.</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="config-dev-mode"/>19.1.9. Development Mode</h3></div></div></div><p>Some features of the <a class="link" href="devmode.html" title="Chapter 21. Development Mode">development mode</a> may have negative impact on the performance and/or functionality of the application. The following configuration properties allow to tune or disable these features, e.g. to specify the set of components which will be monitored.</p><div class="table"><a id="d0e6384"/><p class="title"><b>Table 19.9. Supported configuration properties</b></p><div class="table-contents"><table summary="Supported configuration properties" border="1"><colgroup><col/><col/><col/><col/></colgroup><thead><tr><th align="left" valign="top">Configuration key</th><th align="left" valign="top">Tool</th><th align="left" valign="top">Default value</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">org.jboss.weld.probe.invocationMonitor.excludeType</code></p></td><td align="left" valign="top"><p><a class="link" href="devmode.html#probe" title="21.2.1. Probe">Probe</a></p></td><td align="left" valign="top"><p>''</p></td><td align="left" valign="top"><p>A regular expression. If a non-empty string and the base type for an AnnotatedType or a declaring type for an AnnotatedMember matches this pattern the type is excluded from monitoring.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">org.jboss.weld.probe.invocationMonitor.skipJavaBeanProperties</code></p></td><td align="left" valign="top"><p><a class="link" href="devmode.html#probe" title="21.2.1. Probe">Probe</a></p></td><td align="left" valign="top"><p><span class="emphasis"><em>true</em></span></p></td><td align="left" valign="top"><p>If set to <code class="literal">true</code>, the JavaBean accessor methods are not monitored.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">org.jboss.weld.probe.eventMonitor.excludeType</code></p></td><td align="left" valign="top"><p><a class="link" href="devmode.html#probe" title="21.2.1. Probe">Probe</a></p></td><td align="left" valign="top"><p>''</p></td><td align="left" valign="top"><p>A regular expression. If a non-empty string  and the runtime class of the event object matches this pattern the event is excluded from monitoring.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">org.jboss.weld.probe.embedInfoSnippet</code></p></td><td align="left" valign="top"><p><a class="link" href="devmode.html#probe" title="21.2.1. Probe">Probe</a></p></td><td align="left" valign="top"><p><span class="emphasis"><em>true</em></span></p></td><td align="left" valign="top"><p>If set to <code class="literal">true</code> an informative HTML snippet will be added to every HTTP response with Content-Type of value <code class="literal">text/html</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">org.jboss.weld.probe.jmxSupport</code></p></td><td align="left" valign="top"><p><a class="link" href="devmode.html#probe" title="21.2.1. Probe">Probe</a></p></td><td align="left" valign="top"><p><span class="emphasis"><em>false</em></span></p></td><td align="left" valign="top"><p>If set to <code class="literal">true</code> one or more MBean components may be registered so that it’s possible to use JMX to access the Probe development tool data.</p></td></tr></tbody></table></div></div><br class="table-break"/><div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>Tip</h2><p>To disable the monitoring entirely set <code class="literal">org.jboss.weld.probe.invocationMonitor.excludeType</code> and <code class="literal">org.jboss.weld.probe.eventMonitor.excludeType</code> properties to <code class="literal">.*</code>.</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="_default_bean_names"/>19.1.10. Default bean names</h3></div></div></div><p>There was <a class="ulink" href="https://issues.jboss.org/browse/WELD-1941">a bug</a> in Weld where the default name of a bean did not met the CDI specification requirements. This bug is fixed in Weld 2.2.14.Final and later versions. However, this fix is not backward compatible. Therefore, a special cofiguration option may be used to switch to the legacy strategy to infer the default bean names.</p><div class="table"><a id="d0e6513"/><p class="title"><b>Table 19.10. Supported configuration properties</b></p><div class="table-contents"><table summary="Supported configuration properties" border="1"><colgroup><col/><col/><col/></colgroup><thead><tr><th align="left" valign="top">Configuration key</th><th align="left" valign="top">Default value</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">org.jboss.weld.bean.defaultNamesFollowJavaBeanRules</code></p></td><td align="left" valign="top"><p>false</p></td><td align="left" valign="top"><p>If set to <code class="literal">true</code>, the default names follow the rules from the original JavaBean specification. Otherwise (default, portable solution), the CDI specification requirements are met.</p></td></tr></tbody></table></div></div><br class="table-break"/></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="_excluding_classes_from_scanning_and_deployment"/>19.2. Excluding classes from scanning and deployment</h2></div></div></div><p>CDI 1.1 allows you to exclude classes in your archive from being
scanned, having container lifecycle events fired, and being deployed as
beans. See also
<a class="ulink" href="http://docs.jboss.org/cdi/spec/1.1/cdi-spec.html#bean_discovery">12.4.
Bean discovery</a>.</p><div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>Note</h2><p>Weld still supports the original non-portable way of excluding classes
from discovery. The formal specification can be found in the xsd,
located at <a class="ulink" href="http://jboss.org/schema/weld/beans_1_1.xsd">http://jboss.org/schema/weld/beans_1_1.xsd</a>. Unlike Weld, the
CDI specification does not support regular expression patterns and <code class="literal">!</code>
character to invert the activation condition.</p></div><p>All the configuration is done in the <code class="literal">beans.xml</code> file. For more
information see <a class="xref" href="ee.html#packaging-and-deployment" title="15.6. Packaging and deployment">Section 15.6, “Packaging and deployment”</a>.</p><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_processing_instruction">&lt;?xml&nbsp;version=&quot;1.0&quot;&nbsp;encoding=&quot;UTF-8&quot;?&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">beans</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">xmlns</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">scan</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_comment">&lt;!--&nbsp;Don't&nbsp;deploy&nbsp;the&nbsp;classes&nbsp;for&nbsp;the&nbsp;swing&nbsp;app!&nbsp;--&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">exclude</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;com.acme.swing.**&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_comment">&lt;!--&nbsp;Don't&nbsp;include&nbsp;GWT&nbsp;support&nbsp;if&nbsp;GWT&nbsp;is&nbsp;not&nbsp;installed&nbsp;--&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">exclude</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;com.acme.gwt.**&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">if-class-not-available</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;com.google.GWT&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">exclude</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_comment">&lt;!--</span><span class="xml_plain"></span><br />
<span class="xml_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exclude&nbsp;types&nbsp;from&nbsp;com.acme.verbose&nbsp;package&nbsp;if&nbsp;the&nbsp;system&nbsp;property&nbsp;verbosity&nbsp;is&nbsp;set&nbsp;to&nbsp;low</span><span class="xml_plain"></span><br />
<span class="xml_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.e.</span><span class="xml_plain"></span><br />
<span class="xml_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;java&nbsp;...&nbsp;-Dverbosity=low</span><span class="xml_plain"></span><br />
<span class="xml_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">exclude</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;com.acme.verbose.*&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">if-system-property</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;verbosity&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">value</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;low&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">exclude</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_comment">&lt;!--</span><span class="xml_plain"></span><br />
<span class="xml_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Don't&nbsp;include&nbsp;JSF&nbsp;support&nbsp;if&nbsp;Wicket&nbsp;classes&nbsp;are&nbsp;present,&nbsp;and&nbsp;the&nbsp;viewlayer&nbsp;system</span><span class="xml_plain"></span><br />
<span class="xml_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;property&nbsp;is&nbsp;set</span><span class="xml_plain"></span><br />
<span class="xml_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">exclude</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;com.acme.jsf.**&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">if-class-available</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.apache.wicket.Wicket&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">if-system-property</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;viewlayer&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">exclude</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">scan</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">beans</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><p>In this example we show the most common use cases for exercising fine
control over which classes Weld scans. The first filter excludes all
types whose package name starts with <code class="literal">com.acme.swing</code>, and in most cases
this will be sufficient for your needs.</p><p>However, sometimes it’s useful to be able to activate the filter
depending on the environment used. In this case, Weld allows you to
activate (or deactivate) a filter based on either system properties or
whether a class is available. The second filter shows the use case of
disabling scanning of certain classes depending on the capabilities of
the environment you deploy to - in this case we are excluding GWT
support (all types whose package name starts with <code class="literal">com.acme.gwt</code>) if GWT
is not installed.</p><div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>Note</h2><p>If you specify just a system property name, Weld will activate the
filter if that system property has been set (with any value). If you
also specify the system property value, then Weld will only activate the
filter if the system property’s value matches exactly.</p></div><p>The third filter shows how to exclude all types from a specific package
(note the <code class="literal">name</code> attribute has suffix ".*").</p><p>The fourth filter shows more a advanced configurations, where we use
multiple activation conditions to decide whether to activate the filter.</p><p>You can combine as many activation conditions as you like (<span class="emphasis"><em>all</em></span> must be
true for the filter to be activated). If you want to a filter that is
active if <span class="emphasis"><em>any</em></span> of the activation conditions are true, then you need
multiple identical filters, each with different activation conditions.</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="_mapping_cdi_contexts_to_http_requests"/>19.3. Mapping CDI contexts to HTTP requests</h2></div></div></div><p>By default, CDI contexts are activated at the beginning of an HTTP
request processing and deactivated once the processing finishes. This
may represent an unnecessary overhead in certain situations, for example
static resource serving.</p><p>Weld allows CDI context support to be mapped to a certain subset of
requests only. A regular expression may be used for filtering HTTP
requests that should have CDI contexts active during their processing.</p><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">web-app</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">version</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;3.1&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">xmlns</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://xmlns.jcp.org/xml/ns/javaee/&quot;</span><span class="xml_plain"></span><br />
<span class="xml_attribute_name">xmlns:xsi</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class="xml_plain"></span><br />
<span class="xml_attribute_name">xsi:schemaLocation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://xmlns.jcp.org/xml/ns/javaee&nbsp;http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">context-param</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">param-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.jboss.weld.context.mapping</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">param-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">param-value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">.*\.html</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">param-value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">context-param</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">web-app</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre></div></div><ul xmlns:d="http://docbook.org/ns/docbook" class="docnav"><li class="previous"><a accesskey="p" href="environments.html"><strong>Prev</strong>Chapter 18. Application servers and environments ...</a></li><li class="up"><a accesskey="u" href="#"><strong>Top of page</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Front page</strong></a></li><li class="next"><a accesskey="n" href="logging.html"><strong>Next</strong>Chapter 20. Logging</a></li></ul></body></html>